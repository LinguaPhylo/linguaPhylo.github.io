## Code

<span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">data {
</span><br>
<span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">&nbsp;&nbsp;</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace"></span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">options</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace"> = </span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">{</span><span style="color: #808080; font-size: 11pt; font-family: monospace,monospace">ageDirection=</span><span style="color: #ff00ff; font-size: 11pt; font-family: monospace,monospace">"forward"</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">, </span><span style="color: #808080; font-size: 11pt; font-family: monospace,monospace">ageRegex=</span><span style="color: #ff00ff; font-size: 11pt; font-family: monospace,monospace">".*\|.*\|(\d*\.\d+|\d+\.\d*)\|.*$"</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">}</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">;
</span><br>
<span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">&nbsp;&nbsp;</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace"></span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">D</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace"> = </span><span style="color: #b200b2; font-size: 11pt; font-family: monospace,monospace">readNexus</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">(</span><span style="color: #808080; font-size: 11pt; font-family: monospace,monospace">file=</span><span style="color: #ff00ff; font-size: 11pt; font-family: monospace,monospace">"tutorials/data/h3n2.nexus"</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">, </span><span style="color: #808080; font-size: 11pt; font-family: monospace,monospace">options=</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">options</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">)</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">;
</span><br>
<span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">&nbsp;&nbsp;</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace"></span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">L</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace"> = </span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">D</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">.</span><span style="color: #b200b2; font-size: 11pt; font-family: monospace,monospace">nchar</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">(</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">)</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">;
</span><br>
<span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">&nbsp;&nbsp;</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace"></span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">demes</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace"> = </span><span style="color: #b200b2; font-size: 11pt; font-family: monospace,monospace">split</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">(</span><span style="color: #808080; font-size: 11pt; font-family: monospace,monospace">str=</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">D</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">.</span><span style="color: #b200b2; font-size: 11pt; font-family: monospace,monospace">taxaNames</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">(</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">)</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">, </span><span style="color: #808080; font-size: 11pt; font-family: monospace,monospace">regex=</span><span style="color: #ff00ff; font-size: 11pt; font-family: monospace,monospace">"\|"</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">, </span><span style="color: #808080; font-size: 11pt; font-family: monospace,monospace">i=</span><span style="color: #ff00ff; font-size: 11pt; font-family: monospace,monospace">3</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">)</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">;
</span><br>
<span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">&nbsp;&nbsp;</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace"></span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">S</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace"> = </span><span style="color: #b200b2; font-size: 11pt; font-family: monospace,monospace">length</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">(</span><span style="color: #b200b2; font-size: 11pt; font-family: monospace,monospace">unique</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">(</span><span style="color: #808080; font-size: 11pt; font-family: monospace,monospace">arg=</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">demes</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">)</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">)</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">;
</span><br>
<span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">&nbsp;&nbsp;</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace"></span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">dim</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace"> = </span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">S</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">*</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">(</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">S</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">-</span><span style="color: #ff00ff; font-size: 11pt; font-family: monospace,monospace">1</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">)</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">;
</span><br>
<span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">&nbsp;&nbsp;</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace"></span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">taxa</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace"> = </span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">D</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">.</span><span style="color: #b200b2; font-size: 11pt; font-family: monospace,monospace">taxa</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">(</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">)</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">;
</span><br>
<span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">}
</span><br>
<span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">model {
</span><br>
<span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">&nbsp;&nbsp;</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace"></span><span style="color: #00ff00; font-size: 11pt; font-family: monospace,monospace">Ï€</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace"> ~ </span><span style="color: #0000ff; font-size: 11pt; font-family: monospace,monospace">Dirichlet</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">(</span><span style="color: #808080; font-size: 11pt; font-family: monospace,monospace">conc=</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">[</span><span style="color: #ff00ff; font-size: 11pt; font-family: monospace,monospace">2.0</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">, </span><span style="color: #ff00ff; font-size: 11pt; font-family: monospace,monospace">2.0</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">, </span><span style="color: #ff00ff; font-size: 11pt; font-family: monospace,monospace">2.0</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">, </span><span style="color: #ff00ff; font-size: 11pt; font-family: monospace,monospace">2.0</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">]</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">);
</span><br>
<span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">&nbsp;&nbsp;</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace"></span><span style="color: #00ff00; font-size: 11pt; font-family: monospace,monospace">Îº</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace"> ~ </span><span style="color: #0000ff; font-size: 11pt; font-family: monospace,monospace">LogNormal</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">(</span><span style="color: #808080; font-size: 11pt; font-family: monospace,monospace">meanlog=</span><span style="color: #ff00ff; font-size: 11pt; font-family: monospace,monospace">1.0</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">, </span><span style="color: #808080; font-size: 11pt; font-family: monospace,monospace">sdlog=</span><span style="color: #ff00ff; font-size: 11pt; font-family: monospace,monospace">1.25</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">);
</span><br>
<span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">&nbsp;&nbsp;</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace"></span><span style="color: #00ff00; font-size: 11pt; font-family: monospace,monospace">Î¼</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace"> ~ </span><span style="color: #0000ff; font-size: 11pt; font-family: monospace,monospace">LogNormal</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">(</span><span style="color: #808080; font-size: 11pt; font-family: monospace,monospace">meanlog=</span><span style="color: #ff00ff; font-size: 11pt; font-family: monospace,monospace">-5.298</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">, </span><span style="color: #808080; font-size: 11pt; font-family: monospace,monospace">sdlog=</span><span style="color: #ff00ff; font-size: 11pt; font-family: monospace,monospace">0.25</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">);
</span><br>
<span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">&nbsp;&nbsp;</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace"></span><span style="color: #00ff00; font-size: 11pt; font-family: monospace,monospace">Î³</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace"> ~ </span><span style="color: #0000ff; font-size: 11pt; font-family: monospace,monospace">LogNormal</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">(</span><span style="color: #808080; font-size: 11pt; font-family: monospace,monospace">meanlog=</span><span style="color: #ff00ff; font-size: 11pt; font-family: monospace,monospace">0.0</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">, </span><span style="color: #808080; font-size: 11pt; font-family: monospace,monospace">sdlog=</span><span style="color: #ff00ff; font-size: 11pt; font-family: monospace,monospace">2.0</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">);
</span><br>
<span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">&nbsp;&nbsp;</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace"></span><span style="color: #00ff00; font-size: 11pt; font-family: monospace,monospace">r</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace"> ~ </span><span style="color: #0000ff; font-size: 11pt; font-family: monospace,monospace">DiscretizeGamma</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">(</span><span style="color: #808080; font-size: 11pt; font-family: monospace,monospace">shape=</span><span style="color: #00ff00; font-size: 11pt; font-family: monospace,monospace">Î³</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">, </span><span style="color: #808080; font-size: 11pt; font-family: monospace,monospace">ncat=</span><span style="color: #ff00ff; font-size: 11pt; font-family: monospace,monospace">4</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">, </span><span style="color: #808080; font-size: 11pt; font-family: monospace,monospace">replicates=</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">L</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">);
</span><br>
<span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">&nbsp;&nbsp;</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace"></span><span style="color: #00ff00; font-size: 11pt; font-family: monospace,monospace">m</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace"> ~ </span><span style="color: #0000ff; font-size: 11pt; font-family: monospace,monospace">Exp</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">(</span><span style="color: #808080; font-size: 11pt; font-family: monospace,monospace">mean=</span><span style="color: #ff00ff; font-size: 11pt; font-family: monospace,monospace">1.0</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">, </span><span style="color: #808080; font-size: 11pt; font-family: monospace,monospace">replicates=</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">dim</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">);
</span><br>
<span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">&nbsp;&nbsp;</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace"></span><span style="color: #00ff00; font-size: 11pt; font-family: monospace,monospace">Î˜</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace"> ~ </span><span style="color: #0000ff; font-size: 11pt; font-family: monospace,monospace">LogNormal</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">(</span><span style="color: #808080; font-size: 11pt; font-family: monospace,monospace">sdlog=</span><span style="color: #ff00ff; font-size: 11pt; font-family: monospace,monospace">1.0</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">, </span><span style="color: #808080; font-size: 11pt; font-family: monospace,monospace">meanlog=</span><span style="color: #ff00ff; font-size: 11pt; font-family: monospace,monospace">0.0</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">, </span><span style="color: #808080; font-size: 11pt; font-family: monospace,monospace">replicates=</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">S</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">);
</span><br>
<span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">&nbsp;&nbsp;</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace"></span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">M</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace"> = </span><span style="color: #b200b2; font-size: 11pt; font-family: monospace,monospace">migrationMatrix</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">(</span><span style="color: #808080; font-size: 11pt; font-family: monospace,monospace">theta=</span><span style="color: #00ff00; font-size: 11pt; font-family: monospace,monospace">Î˜</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">, </span><span style="color: #808080; font-size: 11pt; font-family: monospace,monospace">m=</span><span style="color: #00ff00; font-size: 11pt; font-family: monospace,monospace">m</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">)</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">;
</span><br>
<span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">&nbsp;&nbsp;</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace"></span><span style="color: #00ff00; font-size: 11pt; font-family: monospace,monospace">Ïˆ</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace"> ~ </span><span style="color: #0000ff; font-size: 11pt; font-family: monospace,monospace">StructuredCoalescent</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">(</span><span style="color: #808080; font-size: 11pt; font-family: monospace,monospace">M=</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">M</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">, </span><span style="color: #808080; font-size: 11pt; font-family: monospace,monospace">demes=</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">demes</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">, </span><span style="color: #808080; font-size: 11pt; font-family: monospace,monospace">sort=</span><span style="color: #ff00ff; font-size: 11pt; font-family: monospace,monospace">true</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">, </span><span style="color: #808080; font-size: 11pt; font-family: monospace,monospace">taxa=</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">taxa</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">);
</span><br>
<span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">&nbsp;&nbsp;</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace"></span><span style="color: #00ff00; font-size: 11pt; font-family: monospace,monospace">D</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace"> ~ </span><span style="color: #0000ff; font-size: 11pt; font-family: monospace,monospace">PhyloCTMC</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">(</span><span style="color: #808080; font-size: 11pt; font-family: monospace,monospace">Q=</span><span style="color: #b200b2; font-size: 11pt; font-family: monospace,monospace">hky</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">(</span><span style="color: #808080; font-size: 11pt; font-family: monospace,monospace">kappa=</span><span style="color: #00ff00; font-size: 11pt; font-family: monospace,monospace">Îº</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">, </span><span style="color: #808080; font-size: 11pt; font-family: monospace,monospace">freq=</span><span style="color: #00ff00; font-size: 11pt; font-family: monospace,monospace">Ï€</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">)</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">, </span><span style="color: #808080; font-size: 11pt; font-family: monospace,monospace">mu=</span><span style="color: #00ff00; font-size: 11pt; font-family: monospace,monospace">Î¼</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">, </span><span style="color: #808080; font-size: 11pt; font-family: monospace,monospace">siteRates=</span><span style="color: #00ff00; font-size: 11pt; font-family: monospace,monospace">r</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">, </span><span style="color: #808080; font-size: 11pt; font-family: monospace,monospace">tree=</span><span style="color: #00ff00; font-size: 11pt; font-family: monospace,monospace">Ïˆ</span><span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">);
</span><br>
<span style="color: #000000; font-size: 11pt; font-family: monospace,monospace">}
</span><br>

## Graphical Model


<figure class="image">
  <a href="GraphicalModel.png" target="_blank">
    <img src="GraphicalModel.png" alt="GraphicalModel.png">
  </a>
  <figcaption>{{ include.fignum }}: The graphical model</figcaption>
</figure>



For the details, please read the auto-generated [narrative](#auto-generated) from LPhyStudio.
